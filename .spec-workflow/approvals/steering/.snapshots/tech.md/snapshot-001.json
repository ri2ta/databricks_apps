{
  "id": "snapshot_1766897749671_pwl9xc9p8",
  "approvalId": "approval_1766897749668_29q8bls7z",
  "approvalTitle": "Steering Tech Document",
  "version": 1,
  "timestamp": "2025-12-28T04:55:49.671Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Technology Stack\n\n## Project Type\nDatabricks Apps 上で動作する Flask ベースのサーバー駆動 Web アプリ（HTMX + Tailwind + DaisyUI + Alpine.js）。モデル駆動 CRUD フレームワークを提供。\n\n## Core Technologies\n\n### Primary Language(s)\n- **Language**: Python 3.x\n- **Runtime/Compiler**: Databricks Apps ランタイム（Python）、ローカル開発は devcontainer の Python。\n- **Language-specific tools**: pip、venv/conda（開発環境）。\n\n### Key Dependencies/Libraries\n- **Flask**: Web フレームワーク。\n- **HTMX**: サーバー駆動の部分更新。\n- **Tailwind CSS + DaisyUI**: スタイルとコンポーネント。\n- **Alpine.js**: 軽量な UI 状態管理。\n- **(将来) SQLAlchemy/DBAPI**: データアクセス抽象化（現状 `db.py` でプール管理）。\n\n### Application Architecture\n- シングル Flask アプリ（モノリシック）で HTMX 部分テンプレートを返却。\n- UI レイアウト・コンポーネントは `templates/` 配下に集約。\n- データアクセスは `db.py` に集約し、サービス/リポジトリ層への拡張を想定。\n\n### Data Storage (if applicable)\n- **Primary storage**: RDB (Databricks SQL Warehouse/Cluster 経由を想定)。\n- **Caching**: なし（必要に応じてアプリ内メモリキャッシュを検討）。\n- **Data formats**: HTML (HTMX partials), JSON (API/内部処理), YAML (エンティティ定義)。\n\n### External Integrations (if applicable)\n- Databricks SQL / Unity Catalog を利用したテーブルアクセスを想定。\n- 認証/認可は Databricks Apps の枠組み＋将来の追加ミドルで拡張を検討。\n\n### Monitoring & Dashboard Technologies (if applicable)\n- サーバーログ出力（Flask logging + db.py ログ統合）。\n- Apps 側でのメトリクス集約（将来: レイテンシ/エラー率の可視化ダッシュボード）。\n\n## Development Environment\n\n### Build & Development Tools\n- **Build System**: なし（Flask 実行のみ）。\n- **Package Management**: pip (`requirements.txt`)。\n- **Development workflow**: devcontainer でのローカル実行、ホットリロードは Flask の debug モードで代替（必要なら watch ツールを追加）。\n\n### Code Quality Tools\n- **Static Analysis**: ruff（推奨）、mypy（将来）。\n- **Formatting**: ruff/black（未固定、今後選定）。\n- **Testing Framework**: pytest（HTMX 応答の部分 HTML 検証を想定）。\n- **Documentation**: Markdown（docs/ 配下）。\n\n### Version Control & Collaboration\n- **VCS**: Git（GitHub Flow を前提に運用）。\n- **Branching Strategy**: main 基軸の小刻み PR。\n- **Code Review Process**: PR ベース、ruff/pytest/mypy を推奨。\n\n### Dashboard Development (if applicable)\n- 現状なし。必要に応じて HTMX/Alpine で運用向け UI を追加。\n\n## Deployment & Distribution (if applicable)\n- **Target Platform(s)**: Databricks Apps（本番）。ローカルは devcontainer で再現。\n- **Distribution Method**: Apps ワークスペース内デプロイ。\n- **Installation Requirements**: Databricks ランタイム + Python、Secrets/SQL Warehouse への接続設定。\n- **Update Mechanism**: GitHub → Apps への再デプロイ。将来 CI/CD を整備。\n\n## Technical Requirements & Constraints\n\n### Performance Requirements\n- HTMX 応答 P95 < 500ms を目標（Apps 内計測）。\n- 最小メモリフットプリントで複数同時接続を処理できること。\n\n### Compatibility Requirements  \n- **Platform Support**: Databricks Apps + ローカル devcontainer（Linux ベース）。\n- **Dependency Versions**: Flask 2.x 系、HTMX/Tailwind/DaisyUI/Alpine は最新版安定版を利用。\n- **Standards Compliance**: HTTP/HTML ベース。セキュリティヘッダは Flask で追加予定。\n\n### Security & Compliance\n- Secrets は Databricks Secret Scope／環境変数経由で注入しハードコード禁止。\n- 入力バリデーションとエラーハンドリングを共通化予定。\n- ログの個人情報扱いに注意し、必要ならマスキングを行う。\n\n### Scalability & Reliability\n- 予想負荷: 少量〜中規模の業務 CRUD。Apps スケールに依存。\n- Availability: Apps の稼働保証に依存。将来はリトライ/タイムアウトを明示設定。\n- 成長に合わせてサービス/リポジトリ分割やキャッシュ導入を検討。\n\n## Technical Decisions & Rationale\n1. **HTMX + Flask（サーバー駆動）**: JS 薄めで保守容易。Databricks Apps と相性が良い。\n2. **Tailwind + DaisyUI**: UI ルックを統一しつつカスタマイズ性を確保。\n3. **YAML モデル定義**: 宣言的に UI を生成し、拡張ポイントを持たせるため。\n4. **単一アプリ構成**: 初期スコープを小さくし、後でサービス分割できる余地を残す。\n\n## Known Limitations\n- 認証/認可の詳細設計が未記載（Apps 標準を前提、将来拡張）。\n- 観測性（メトリクス/トレース）実装はこれから。\n- DB アクセス抽象化は簡易 (`db.py`)。スキーマ管理やマイグレーションは未整備。\n",
  "fileStats": {
    "size": 5212,
    "lines": 96,
    "lastModified": "2025-12-28T04:55:47.795Z"
  },
  "comments": []
}